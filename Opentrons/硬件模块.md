# 硬件模块

## 模块设置

### 加载一个模块到台面上

使用`ProtocolContext.load_module()`来加载一个模块。

```python
from opentrons import protocol_api

metadata = {'apiLevel': '2.13'}

def run(protocol: protocol_api.ProtocolContext):
     # Load a Magnetic Module GEN2 in deck slot 1.
     magnetic_module = protocol.load_module('magnetic module gen2', 1)

     # Load a Temperature Module GEN1 in deck slot 3.
     temperature_module = protocol.load_module('temperature module', 3)
```

| Module                   | Load Name                                            | Introduced in API Version |
| :----------------------- | :--------------------------------------------------- | :------------------------ |
| Temperature Module GEN1  | `temperature module` or `tempdeck`                   | 2.0                       |
| Temperature Module GEN2  | `temperature module gen2`                            | 2.3                       |
| Magnetic Module GEN1     | `magnetic module` or `magdeck`                       | 2.0                       |
| Magnetic Module GEN2     | `magnetic module gen2`                               | 2.3                       |
| Thermocycler Module GEN1 | `thermocycler module` or `thermocycler`              | 2.0                       |
| Thermocycler Module GEN2 | `thermocycler module gen2` or `thermocyclerModuleV2` | 2.13                      |
| Heater-Shaker Module     | `heaterShakerModuleV1`                               | 2.13                      |

### 在一个模块上加载实验器具

与直接加载在OT-2的台面上一样。,使用`load_labware()`来加载一个实验器具。

```python
from opentrons import protocol_api

metadata = {'apiLevel': '2.3'}

def run(protocol: protocol_api.ProtocolContext):
    temp_mod = protocol.load_module("temperature module gen2", 1)
    temp_labware = temp_mod.load_labware(
        "opentrons_24_aluminumblock_generic_2ml_screwcap",
        label="Temperature-Controlled Tubes",
    )
```

区别是，在一个模块上加载一个实验器具，不需要阐明台面的槽号。

#### 模块和实验器具的兼容

需要保证模块和实验器具的组合有意义。如果你加载了一个无意义的组合，Protocol API不会报警或报错，如将一个试管架放在一个热循环仪上。

#### 额外的实验器具参数

除了必须的`load_name`参数以外，还可以指定额外的参数。

* 标签(`label`)：标签将显示在Opentrons App和运行日志里，而不是`load_name`
* 版本(`version`)和命名空间(`namespace`)：如果实验器具有多个定义，就可以指定版本和命名空间。

### 使用温度模块

温度范围：4°-95°，分辨率为1°。

* 设置目标温度
* 读取模块状态

```python
from opentrons import protocol_api

metadata = {'apiLevel': '2.3'}

def run(protocol: protocol_api.ProtocolContext):
    temp_mod = protocol.load_module('temperature module gen2', '3')
    plate = temp_mod.load_labware('corning_96_wellplate_360ul_flat')
```

为了防止其他插槽的物理障碍，最好将温度模块装入甲板水平边缘的插槽中（左侧：1、4、7、10，右侧：3、6、9），USB电缆和电源线指向原理甲板的位置。

#### 温度控制

设置台面的温度：`set_temperature`，参数：`celsius`

```python
temp_mod.set_temperature(celsius=4)
```

当在协议中使用设置温度时，该动作将会等待直到目标温度到达，才会执行后面的步骤。

当模块温度保持温度或空闲时可以进行移液，但不能在温度模块改变温度时。

当模块到达目标温度后，模块将保持温度，直到设置不同的目标或调用`deactivate()`，这将会停止加热或冷却并关闭风扇。

#### 温度状态

如果你需要确认温度模块是否保持温度或是否空闲，可以使用`status`属性：

```python
temp_mod.set_temperature(celsius=90)
temp_mod.status  # 'holding at target'
temp_mod.deactivate()
temp_mod.status  # 'idle'
```

如果你不需要在代码中使用状态值，且具有对模块的物理访问权限，则可以从LED读取状态和温度，并在模块上显示。

### 使用一个加热振荡模块

提供加热和轨道加热。

加热范围：37° - 95°。

转速：200 rpm - 3000 rpm

```python
from opentrons import protocol_api

metadata = {'apiLevel': '2.13'}

def run(protocol: protocol_api.ProtocolContext):
     hs_mod = protocol.load_module('heaterShakerModuleV1', 1)
```

要求 api 版本：2.13

#### 位置限制

走线问题，加热振荡模块应该仅被放置在槽1、3、4、6、7、10。

一般来说，最好在两个方向上让加热振荡器附近的所有槽都空着。

如果你要使用这些槽，遵守一些限制：

* 不能放置其它任何模块在加热振动器附近。防止摇动和打开振荡器闩锁时发生碰撞。会引发`DeckConflictError`。
* 不能放置高的实验室器具(定义为>53 mm)在左侧或右侧。防止加热振荡器的的插销和相邻的器具碰撞。也会引发`DeckConflictError`。超过高度的常见器具包括 opentrons 管架和opentrons 1000ul枪头盒。
* 如果使用的时8通道移液管，则不能在任何相邻的槽中执行移液操作。会引发`PipetteMovementRestrictedByHeaterShakerError`。防止移液管喷射器撞击模块外壳或闩锁。（有一个例外，在加热振动台的前后，8通道移液管只能靠近枪头盒。）

#### 闩锁控制

```python
open_labware_latch()
close_labware_latch()
```

振荡动作要求闩锁被关闭。所以，在振荡命令之前，要先关闭闩锁。

```python
hs_mod.close_labware_latch()
hs_mod.set_and_wait_for_shake_speed(500)
```

如果闩锁已经被关闭，再次执行关闭会立即成功。在打开或关闭之前不需要检查闩锁的状态。

#### 加载器具

| Adapter                | Labware                                  | Definition                                                   |
| :--------------------- | :--------------------------------------- | :----------------------------------------------------------- |
| Deep Well Adapter      | NEST 96 Deep Well Plate 2mL              | `opentrons_96_deep_well_adapter_nest_wellplate_2ml_deep`     |
| 96 Flat Bottom Adapter | NEST 96 Well Plate 200 µL Flat           | `opentrons_96_flat_bottom_adapter_nest_wellplate_200ul_flat` |
| PCR Adapter            | NEST 96 Well Plate 100 µL PCR Full Skirt | `opentrons_96_pcr_adapter_nest_wellplate_100ul_pcr_full_skirt` |
| PCR Adapter            | Thermo Scientific Armadillo PCR Plate    | `opentrons_96_pcr_adapter_armadillo_wellplate_200ul`         |
| Universal Flat Adapter | Corning 384 Well Plate 112 µL Flat       | `opentrons_universal_flat_adapter_corning_384_wellplate_112ul_flat` |

#### 加热和振荡
