# 存储类

存储类定义C程序中变量/函数的存储位置、生命周期和作用域。

* auto
* register
* static
* extern

## auto存储类

auto存储类是所有局部变量默认的存储类。

定义在函数中的变量默认为auto存储类：

* 在函数开始时被创建
* 在函数结束时被销毁

auto只能用在函数内，即auto只能修饰局部变量。

## register存储类

**register存储类用于定义存储在寄存器中而不是RAM中的局部变量。**

* 变量的最大尺寸等于寄存器的大小（通常是一个字）
* 不能对register变量应用一元的`&`运算符(因为没有内存位置)

寄存器只用于需要快速访问的变量，比如计数器。

需要注意的是，定义`register`并不意味着变量将被存储在寄存器中，它意味着变量可能存储在寄存器中，这取决于硬件和实现的限制。

## static存储类

**static 存储类指示编译器在程序的生命周期内保持局部变量的存在，而不需要在每次它进入和离开作用域时进行创建和销毁。**

* 使用 static 修饰局部变量可以在函数调用之间保持局部变量的值。
* static 修饰符也可以应用于全局变量。
  * 当 static 修饰全局变量时，会使变量的作用域限制在声明它的文件内。
  * 全局声明的一个 static 变量或方法可以被任何函数或方法调用，只要这些方法出现在跟 static 变量或方法同一个文件中。
* 静态变量在程序中只被初始化一次，即使函数被调用多次，该变量的值也不会重置。

```c
#include <stdio.h>
 
/* 函数声明 */
void func1(void);
 
static int count=10;        /* 全局变量 - static 是默认的 */
 
int main()
{
  while (count--) {
      func1();
  }
  return 0;
}
 
void func1(void)
{
/* 'thingy' 是 'func1' 的局部变量 - 只初始化一次
 * 每次调用函数 'func1' 'thingy' 值不会被重置。
 */                
  static int thingy=5;
  thingy++;
  printf(" thingy 为 %d ， count 为 %d\n", thingy, count);
}
```

## extern存储类

extern 存储类用于定义在其他文件中声明的全局变量或函数。当使用 extern 关键字时，不会为变量分配任何存储空间，而只是指示编译器该变量在其他文件中定义。

**extern 存储类用于提供一个全局变量的引用**，全局变量对所有的程序文件都是可见的。当您使用 extern 时，对于无法初始化的变量，会把变量名指向一个之前定义过的存储位置。

当您有多个文件且定义了一个可以在其他文件中使用的全局变量或函数时，可以在其他文件中使用 extern 来得到已定义的变量或函数的引用。可以这么理解，extern 是用来在另一个文件中声明一个全局变量或函数。